function userLogout(){$.ajax({url:"/user/logout",success:function(){}})}function userGetInfo(){$.ajax({url:"/user/getprofile",success:function(o){o.email?displayProfile(o):$(".user-login").show()}})}function displayProfile(o){$(".user-info").html(o.displayName)}function getCheckinLocation(){console.log("geolocating"),navigator.geolocation||console.log("Geolocation is not available"),map.locate();var o=L.mapbox.featureLayer().addTo(map);map.on("locationfound",function(e){forwardGeocode(e.latlng.lat,e.latlng.lng),console.log("location found"),map.setView([e.latlng.lat,e.latlng.lng],16),o.setGeoJSON({type:"Feature",geometry:{type:"Point",coordinates:[e.latlng.lng,e.latlng.lat]},properties:{title:"Here I am!","marker-color":"#04A195","marker-symbol":"rocket"}})}),map.on("locationerror",function(){console.log("Position could not be found")})}function forwardGeocode(o,e){checkinObj.addressLat=o,checkinObj.addressLng=e,$.ajax({url:"https://api.mapbox.com/v4/geocode/mapbox.places/"+e+","+o+".json?access_token="+mapboxToken,success:function(o){displayCheckinData(o)}})}function displayCheckinData(o){checkinObj.addressFull=o.features[0].place_name,checkinObj.addressNumber=o.features[0].address,checkinObj.addressShort=o.features[0].text,checkinObj.addressCity=o.features[1].text,console.log(checkinObj),$(".checkin-info .address").append(checkinObj.addressNumber+" "+checkinObj.addressShort)}function submitCheckinData(){console.log(checkinObj),$.ajax({method:"POST",url:"/mapdata/addtrucklocation",data:checkinObj,success:function(o){window.location="/"}})}var mapboxToken="pk.eyJ1IjoianJrZWNrIiwiYSI6IjgzZTA0NmVhOGUxMjc2NjhmODYwYmQ3ZGIyZTRkOWQ1In0.XM9mizd6bF8zCqwafrGLDQ",checkinObj={};L.mapbox.accessToken=mapboxToken;var map=L.mapbox.map("map","jrkeck.7fbfb356");map.setView([44.98,-93.2638],13),getCheckinLocation(),$(document).ready(function(){$("body").on("click",".send-location",function(){console.log("click event"),submitCheckinData()})});